---
---
<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Слоняры — Зал славы</title>
  <style>
    :root{
      --bg:#0f1320; --fg:#e9eef7; --muted:#a8b0c3;
      --card:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));
      --stroke:rgba(255,255,255,.10);
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--fg);
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,Cantarell,Arial,sans-serif}
    .wrap{max-width:980px;margin:0 auto;padding:20px}
    header{display:flex;justify-content:space-between;align-items:flex-start;gap:10px;flex-wrap:wrap}
    h1{margin:8px 0 6px;font-size:clamp(24px,6vw,36px);line-height:1.1}
    .sub{color:var(--muted);margin:0 0 12px;max-width:70ch;line-height:1.5}
    .btn{
      display:inline-block;padding:10px 14px;border-radius:999px;
      border:1px solid rgba(255,255,255,.2); background:rgba(255,255,255,.06);
      color:var(--fg); text-decoration:none; transition:.12s ease; white-space:nowrap;
      cursor:pointer;
    }
    .btn:hover{transform:translateY(-1px); background:rgba(255,255,255,.12)}

    .grid{
      display:grid; gap:12px; margin:14px 0 18px;
      grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
    }
    .card{
      border:1px solid var(--stroke); border-radius:14px; overflow:hidden;
      background:var(--card);
      transition:transform .1s ease, box-shadow .12s ease;
      color:inherit;
    }
    .card:hover{transform:translateY(-2px); box-shadow:0 8px 24px rgba(0,0,0,.25)}
    .thumb{display:block;width:100%;aspect-ratio:4/3;object-fit:cover}
    .more-wrap{display:flex;justify-content:center;margin:6px 0 26px}
    .empty{opacity:.8;color:var(--muted);text-align:center;margin:26px 0}

    dialog#lightbox{border:none; padding:0; background:transparent; width:100%;}
    dialog#lightbox::backdrop{background:rgba(0,0,0,.6)}
    .lightbox-inner{
      max-width:min(96vw,1100px); margin:4vh auto; background:#0c1120;
      border:1px solid var(--stroke); border-radius:14px; overflow:hidden;
    }
    .lightbox-media{background:#000}
    .lightbox-media img{display:block;max-height:80vh; width:100%; object-fit:contain}
    .lightbox-meta{padding:12px 14px; display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:flex-end}
    .lightbox-meta .left{margin-right:auto; color:var(--muted)}
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Слоняры</h1>
        <div class="sub">Легенды “Слоняр”: просто скриншоты, без подписей. Нажми — увеличь — сохрани.</div>
      </div>
      <div style="display:flex;gap:10px;flex-wrap:wrap">
        <a class="btn" href="/hof">Назад</a>
        <a class="btn" href="/">На главную</a>
      </div>
    </header>

    <div id="grid" class="grid"></div>
    <div id="empty" class="empty" hidden>Пока пусто. Добавь записи в <b>/public/data/slonyary.json</b>.</div>

    <div class="more-wrap">
      <button id="moreBtn" class="btn" type="button">Показать ещё</button>
    </div>
  </div>

  <dialog id="lightbox">
    <div class="lightbox-inner">
      <div class="lightbox-media"><img id="lbImg" alt=""></div>
      <div class="lightbox-meta">
        <div class="left" id="lbDate"></div>
        <a id="lbOpen" class="btn" href="#" target="_blank" rel="noopener">Открыть</a>
        <a id="lbDownload" class="btn" href="#" download>Скачать</a>
        <button class="btn" type="button" onclick="document.getElementById('lightbox').close()">Закрыть</button>
      </div>
    </div>
  </dialog>

  <script>
    const grid = document.getElementById('grid');
    const moreBtn = document.getElementById('moreBtn');
    const emptyEl = document.getElementById('empty');

    let ITEMS = [];
    let page = 0;
    const PAGE_SIZE = 18;

    function openLightbox(item){
      const dlg = document.getElementById('lightbox');
      document.getElementById('lbImg').src = item.src || '';
      document.getElementById('lbDate').textContent = item.date ? item.date : '';
      const src = item.src || '#';
      document.getElementById('lbOpen').href = src;
      document.getElementById('lbDownload').href = src;
      dlg.showModal();
    }

    document.getElementById('lightbox').addEventListener('click', e=>{
      const dlg = e.currentTarget;
      const rect = dlg.querySelector('.lightbox-inner').getBoundingClientRect();
      const inDialog =
        e.clientX >= rect.left && e.clientX <= rect.right &&
        e.clientY >= rect.top  && e.clientY <= rect.bottom;
      if(!inDialog) dlg.close();
    });

    function render(reset=false){
      if(reset){ grid.innerHTML=''; page=0; }
      const start = page*PAGE_SIZE;
      const slice = ITEMS.slice(start, start+PAGE_SIZE);

      if(reset && ITEMS.length===0){
        emptyEl.hidden = false;
        moreBtn.style.display='none';
        return;
      } else {
        emptyEl.hidden = true;
      }

      for(const item of slice){
        const a = document.createElement('a');
        a.className = 'card';
        a.href = item.src || '#';
        a.addEventListener('click', (e)=>{ e.preventDefault(); openLightbox(item); });

        const img = document.createElement('img');
        img.className = 'thumb';
        img.loading = 'lazy';
        img.src = item.thumb || item.src;
        img.alt = 'Скриншот';

        a.append(img);
        grid.append(a);
      }

      page++;
      moreBtn.style.display = (start + slice.length >= ITEMS.length) ? 'none' : '';
    }

    async function init(){
      try{
        const res = await fetch('/data/slonyary.json', { cache:'no-store' });
        const data = await res.json();
        ITEMS = Array.isArray(data) ? data.filter(x => x && x.src) : [];
        // новые сверху, если есть date
        ITEMS.sort((a,b)=> (b.date||"").localeCompare(a.date||""));
        render(true);
      } catch(e){
        console.error(e);
        emptyEl.hidden = false;
        emptyEl.textContent = 'Ошибка загрузки /data/slonyary.json';
        moreBtn.style.display='none';
      }
    }

    moreBtn.addEventListener('click', ()=>render(false));
    init();
  </script>
</body>
</html>
